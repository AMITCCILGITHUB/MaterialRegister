<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated Apr 26, 2012 8:43:05 PM by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class catalog="metalplants" name="org.map.hibernate.ddo.HeatChartMaster" table="heatchartmaster" dynamic-update="true">
        <id name="chartNumber" type="string">
            <column length="64" name="Chart_Number"/>
            <generator class="assigned"/>
        </id>
        <property name="equipment" type="string">
            <column length="128" name="Equipment" not-null="true"/>
        </property>
        <property name="customer" type="string">
            <column length="128" name="Customer" not-null="true"/>
        </property>
        <property name="poDetails" type="string">
            <column length="128" name="Po_Details" not-null="true"/>
        </property>
        <property name="drawingNumber" type="string">
            <column length="128" name="Drawing_Number" not-null="true"/>
        </property>
        <property name="surveyor" type="string">
            <column length="128" name="Surveyor" not-null="true"/>
        </property>
        <property name="status" type="string">
            <column length="8" name="Status" not-null="true"/>
        </property>
        <property name="createdBy" type="string">
            <column length="32" name="Created_By" not-null="true"/>
        </property>
        <property name="createdDate" type="timestamp">
            <column length="19" name="Created_Date" not-null="true"/>
        </property>
        <set name="heatchartsheets" inverse="true" table="heatchartsheets" cascade="all" order-by="Sequence_Number asc">
            <key>
                <column length="64" name="Chart_Number" not-null="true"/>
            </key>
            <one-to-many class="org.map.hibernate.ddo.HeatChartSheets"/>
        </set>
    </class>
    <sql-query name="nextHcNumberQuery">
        <![CDATA[select concat('HC', date_format(current_timestamp(), '%y'), '/', count(substring(Chart_Number, 3, 2)) + 1) from heatchartmaster]]>
    </sql-query>
    <sql-query name="searchHcNumberQuery">
        <return alias="stock" class="org.map.hibernate.ddo.HeatChartMaster"/>
        <![CDATA[select * from heatchartmaster where substring(substring_index(Chart_Number, '-', 1), 6) between :fromHcNumber and :toHcNumber]]>
    </sql-query>    
</hibernate-mapping>
